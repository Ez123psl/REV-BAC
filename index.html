<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quiz de Révision Interactif Final</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #1a202c; /* Dark background */
            color: #e2e8f0; /* Light text */
            line-height: 1.6;
            margin: 0;
            padding: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            min-height: 100vh;
        }
        .navbar {
            width: 100%;
            background-color: #2d3748; /* Navbar background */
            padding: 10px 0;
            display: flex;
            justify-content: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 20px;
            position: sticky;
            top: 0;
            z-index: 1000;
        }
        .nav-button {
            background-color: #4a5568;
            color: #e2e8f0;
            border: none;
            padding: 10px 15px;
            margin: 0 5px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 15px;
            transition: background-color 0.3s ease;
        }
        .nav-button:hover, .nav-button.active {
            background-color: #63b3ed;
            color: #1a202c;
        }

        .sub-navbar {
            width: 100%;
            background-color: #222a38;
            padding: 8px 0;
            display: none; /* Hidden by default */
            justify-content: center;
            flex-wrap: wrap;
            box-shadow: 0 2px 4px rgba(0,0,0,0.2);
            margin-bottom: 20px;
        }
        .sub-nav-button {
            background-color: #3b4759;
            color: #cbd5e0;
            border: none;
            padding: 8px 12px;
            margin: 5px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            transition: background-color 0.3s ease;
        }
        .sub-nav-button:hover, .sub-nav-button.active {
            background-color: #5289b3;
            color: #e2e8f0;
        }

        .quiz-container {
            max-width: 800px;
            width: 90%;
            margin: 20px auto;
            background-color: #2d3748;
            padding: 25px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
            display: none; /* Hidden by default */
        }
        .quiz-container.active {
            display: block;
        }

        #welcome-message {
            text-align:center;
            font-size: 1.2em;
            padding: 30px;
            background-color: #2d3748;
            border-radius: 8px;
            margin: 20px auto;
            max-width: 700px;
        }

        h1 {
            color: #63b3ed;
            text-align: center;
            margin-bottom: 10px;
        }
        h2.quiz-title {
            color: #90cdf4;
            border-bottom: 2px solid #4a5568;
            padding-bottom: 10px;
            margin-top: 0;
            margin-bottom: 25px;
            text-align: center;
        }
        .question-block {
            margin-bottom: 25px;
            padding: 15px;
            background-color: #4a5568;
            border-radius: 6px;
        }
        .question-block p.question-text {
            margin-top: 0;
            margin-bottom: 10px;
            font-weight: bold;
        }
        .options label {
            display: block;
            margin-bottom: 8px;
            padding: 10px;
            background-color: #2c3e50;
            border-radius: 4px;
            cursor: pointer;
            transition: background-color 0.2s;
        }
        .options label:hover {
            background-color: #34495e;
        }
        .options input[type="radio"] {
            display: none;
        }
        .options label::before {
            content: '';
            display: inline-block;
            width: 16px;
            height: 16px;
            margin-right: 10px;
            border: 2px solid #63b3ed;
            border-radius: 50%;
            vertical-align: middle;
            transition: background-color 0.2s;
        }
        .options input[type="radio"]:checked + label::before {
            background-color: #63b3ed;
        }
        .options input[type="radio"]:checked + label {
            background-color: #2c5282;
            font-weight: bold;
        }

        .submit-quiz-button {
            display: block;
            width: 200px;
            margin: 30px auto 10px;
            padding: 12px 20px;
            background-color: #63b3ed;
            color: #1a202c;
            text-align: center;
            text-decoration: none;
            border: none;
            border-radius: 5px;
            font-weight: bold;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .submit-quiz-button:hover {
            background-color: #4299e1;
        }
        .results-display {
            text-align: center;
            font-size: 1.2em;
            margin-top: 25px;
            padding: 20px;
            background-color: #4a5568;
            border-radius: 6px;
        }
        .feedback {
            margin-top: 8px;
            font-style: italic;
            font-size: 0.9em;
            padding: 5px;
            border-radius: 3px;
        }
        .correct-answer-feedback {
             background-color: rgba(104, 211, 145, 0.2);
             border-left: 3px solid #68d391;
        }
        .incorrect-answer-feedback {
            background-color: rgba(252, 129, 129, 0.2);
            border-left: 3px solid #fc8181;
        }
        .correct { color: #68d391; }
        .incorrect { color: #fc8181; }
    </style>
</head>
<body>

    <div class="navbar">
        <button class="nav-button" onclick="showSubNavbar('histoire-subnav')">Histoire 🟥</button>
        <button class="nav-button" onclick="showSubNavbar('geographie-subnav')">Géographie 🟦</button>
        <button class="nav-button" onclick="showSubNavbar('emc-subnav')">EMC 🟨</button>
        <button class="nav-button" onclick="showSubNavbar('francais-subnav')">Français 🟥🟦</button>
    </div>

    <div id="histoire-subnav" class="sub-navbar">
        <button class="sub-nav-button" onclick="showQuiz('histoire-theme1')">Thème 1: Guerre Froide</button>
        <button class="sub-nav-button" onclick="showQuiz('histoire-theme2')">Thème 2: Décolonisation</button>
    </div>
    <div id="geographie-subnav" class="sub-navbar">
        <button class="sub-nav-button" onclick="showQuiz('geographie-theme1')">Thème 1: Ressources & Dév. Durable</button>
        <button class="sub-nav-button" onclick="showQuiz('geographie-theme2')">Thème 2: Sociétés face aux risques</button>
    </div>
    <div id="emc-subnav" class="sub-navbar">
        <button class="sub-nav-button" onclick="showQuiz('emc-theme1')">Thème: Défis de société & Bioéthique</button>
    </div>
    <div id="francais-subnav" class="sub-navbar">
        <button class="sub-nav-button" onclick="showQuiz('francais-oeuvres')">Œuvres Étudiées</button>
        <button class="sub-nav-button" onclick="showQuiz('francais-figures')">Figures de Style (issues des œuvres)</button>
    </div>

    <div id="welcome-message">
        <h1>Quiz de Révision Interactif</h1>
        <p>Bienvenue ! Choisissez une matière dans le menu ci-dessus, puis un thème pour commencer votre quiz.</p>
    </div>

    <!-- LES QUIZ SERONT INSÉRÉS ICI PAR LE SCRIPT CI-DESSOUS -->
    <!-- ou directement dans le HTML si vous préférez -->
    <div id="quiz-content-area">
        <!-- Histoire - Thème 1 -->
        <div id="histoire-theme1-quiz" class="quiz-container"></div>
        <!-- Histoire - Thème 2 -->
        <div id="histoire-theme2-quiz" class="quiz-container"></div>
        <!-- Géographie - Thème 1 -->
        <div id="geographie-theme1-quiz" class="quiz-container"></div>
        <!-- Géographie - Thème 2 -->
        <div id="geographie-theme2-quiz" class="quiz-container"></div>
        <!-- EMC - Thème 1 -->
        <div id="emc-theme1-quiz" class="quiz-container"></div>
        <!-- Français - Oeuvres -->
        <div id="francais-oeuvres-quiz" class="quiz-container"></div>
        <!-- Français - Figures -->
        <div id="francais-figures-quiz" class="quiz-container"></div>
    </div>

    <script>
        // Data for all quizzes (questions and answers)
        // This would be a very large object if all 105 QCMs were here.
        // For demonstration, I'll include a few questions for the first theme.
        // In a real scenario, this data would be fully populated.

       const quizData = {
    'histoire-theme1': {
        title: "Histoire - Thème 1: La Guerre froide (1947-1991)",
        questions: [
            { q: "En quelle année commence la guerre froide ?", o: ["1945", "1947", "1949", "1950"], a: "b" },
            { q: "Quelles sont les deux doctrines qui s’opposent en 1947 ?", o: ["Doctrine Monroe/Brejnev", "Plan Marshall/Kominform", "Doctrine Truman/Jdanov", "Endiguement/Coexistence"], a: "c" },
            { q: "Qui parle de « rideau de fer » en 1946 ?", o: ["Staline", "Roosevelt", "Churchill", "De Gaulle"], a: "c" },
            { q: "Quels pays occupent l’Allemagne après 1945 ?", o: ["USA/URSS/Chine", "France/UK/USA/URSS", "Italie/Japon", "USA seuls"], a: "b" },
            { q: "Année de division de l’Allemagne ?", o: ["1947", "1948", "1949", "1951"], a: "c" },
            { q: "Noms complets RFA/RDA ?", o: ["Rép. Fédérale Allemande/Rép. Dém. Autrichienne", "Rép. Fédérale d'Allemagne/Rép. Dém. Allemande", "Reich Allemand/RDA", "Allemagne de l'Ouest/Est"], a: "b" },
            { q: "Crise Alliés vs URSS (1948-49) ?", o: ["Cuba", "Mur de Berlin", "Blocus de Berlin", "Corée"], a: "c" },
            { q: "Guerre en Asie en 1950 ?", o: ["Vietnam", "Indochine", "Corée", "Afghanistan"], a: "c" },
            { q: "Événement nucléaire de 1962 ?", o: ["Hiroshima", "Tchernobyl", "Crise des missiles de Cuba", "Essai soviétique"], a: "c" },
            { q: "Moyens utilisés dans la guerre froide ?", o: ["Batailles directes", "Propagande/armement/espace", "Aide humanitaire", "Cyberattaques"], a: "b" },
            { q: "Symbole du mur de Berlin ?", o: ["Paix mondiale", "Division Est/Ouest", "Progrès technique", "Fin URSS"], a: "b" },
            { q: "Chute du mur de Berlin ?", o: ["1987", "1989", "1991", "1993"], a: "b" },
            { q: "Disparition de l’URSS ?", o: ["1989", "1990", "1991", "1992"], a: "c" },
            { q: "Organisation multilatérale de 1945 ?", o: ["OTAN", "ONU", "UE", "Pacte Varsovie"], a: "b" },
            { q: "Définition « guerre froide » ?", o: ["Guerre polaire", "Affrontements indirects", "Guerre informatique", "Conflit médiéval"], a: "b" }
        ]
    },

    'histoire-theme2': {
        title: "Histoire - Thème 2: Décolonisation et Tiers-Monde",
        questions: [
            { q: "Indépendance de l'Inde en 1947 contre ?", o: ["France", "Portugal", "Royaume-Uni", "Espagne"], a: "c" },
            { q: "Pays créé avec l'Inde en 1947 ?", o: ["Bangladesh", "Pakistan", "Sri Lanka", "Népal"], a: "b" },
            { q: "Conférence des non-alignés (1955) ?", o: ["Yalta", "Bandung", "Potsdam", "Alger"], a: "b" },
            { q: "Indépendance algérienne de la France ?", o: ["1954", "1958", "1962", "1965"], a: "c" },
            { q: "Guerre France vs Indochine ?", o: ["1939-1945", "1946-1954", "1954-1962", "1965-1973"], a: "b" },
            { q: "Mouvement des pays pauvres ?", o: ["Tiers-Monde", "Non-alignés", "G20", "OPEP"], a: "a" },
            { q: "Symbole de l'apartheid ?", o: ["Angola", "Afrique du Sud", "Rhodésie", "Kenya"], a: "b" },
            { q: "Pays non-alignés pendant GF ?", o: ["Neutres", "Pro-USA", "Pro-URSS", "Anciennes colonies"], a: "a" },
            { q: "Organisation pour l'autodétermination ?", o: ["OTAN", "ONU", "UE", "Croix-Rouge"], a: "b" },
            { q: "Puissance avec guerres décolonisation ?", o: ["UK", "France", "Espagne", "Portugal"], a: "b" },
            { q: "Accords finissant la guerre d'Algérie ?", o: ["Genève", "Évian", "Versailles", "Oslo"], a: "b" },
            { q: "Dates guerre d'Algérie ?", o: ["1945-1950", "1954-1962", "1962-1967", "1970-1975"], a: "b" },
            { q: "Rôle du Tiers-Monde dans GF ?", o: ["Médiateur", "Terrain d'influence", "Fournisseur d'armes", "Isolé"], a: "b" },
            { q: "Héritages de la colonisation ?", o: ["Démocratie stable", "Inégalités/dépendances", "Développement rapide", "Unité culturelle"], a: "b" },
            { q: "Moyens d'accès à l'indépendance ?", o: ["Sport/diplomatie", "Négociation/guerre", "Cyberattaques", "Boycott culturel"], a: "b" }
        ]
    },
           
            'geographie-theme1': {
        title: "Géographie - Thème 1: Ressources et Développement Durable",
        questions: [
            { q: "Qu'est-ce qu'une ressource ?", o: ["Un produit manufacturé", "Un service économique", "Élément naturel utilisé pour les besoins humains", "Une technologie innovante"], a: "c" },
            { q: "Quel pourcentage de l'eau est utilisé pour l'agriculture ?", o: ["30%", "50%", "70%", "90%"], a: "c" },
            { q: "Quelle ressource est mal répartie à l'échelle mondiale ?", o: ["Le pétrole", "Le charbon", "L'eau", "Le gaz naturel"], a: "c" },
            { q: "Quel fleuve provoque des tensions entre 7 États ?", o: ["Le Nil", "L'Amazone", "Le Colorado", "Le Yangzi Jiang"], a: "c" },
            { q: "Quel type d'agriculture est plus durable ?", o: ["Agriculture intensive", "Monoculture", "Agriculture bio et agroécologique", "Hydroponie"], a: "c" },
            { q: "Que vise la sécurité alimentaire ?", o: ["Exporter plus de produits", "Réduire les coûts de production", "Accès équitable à une nourriture suffisante", "Développer les OGM"], a: "c" },
            { q: "Quel phénomène aggrave la faim dans le monde ?", o: ["La déflation", "Le réchauffement climatique", "La surpopulation", "Les pandémies"], a: "b" },
            { q: "Quel virus illustre le lien santé-environnement ?", o: ["Ebola", "VIH", "Covid-19", "Grippe espagnole"], a: "c" },
            { q: "Quelles plantes recommandées pour économiser l'eau ?", o: ["Cactus", "Plantes tropicales", "Plantes moins gourmandes", "Céréales"], a: "c" },
            { q: "Quel aménagement réduit l'évaporation ?", o: ["Barrages", "Couverture des canaux", "Pivots d'irrigation", "Serres agricoles"], a: "b" },
            { q: "Quelle politique lutte contre le gaspillage ?", o: ["Subventions agricoles", "Interdiction d'exporter", "Redistribution des surplus", "Taxes alimentaires"], a: "c" },
            { q: "Quelle pratique réduit les pesticides ?", o: ["OGM", "Agroécologie", "Labour intensif", "Robotique"], a: "b" },
            { q: "Quel parc montre une gestion durable ?", o: ["Parc de Yellowstone", "Parc national des Calanques", "Parc du Serengeti", "Parc national Banff"], a: "b" },
            { q: "Qu'est-ce que le développement durable ?", o: ["Croissance économique rapide", "Exploitation maximale des ressources", "Répondre aux besoins présents sans compromettre l'avenir", "Protection exclusive de la nature"], a: "c" },
            { q: "Quels sont les 3 piliers du développement durable ?", o: ["Politique, Économique, Social", "Technologique, Culturel, Environnemental", "Économique, Social, Environnemental", "Industriel, Agricole, Urbain"], a: "c" }
        ]
    },
    
    'geographie-theme2': {
        title: "Géographie - Thème 2: Les Sociétés Face aux Risques",
        questions: [
            { q: "Qu'est-ce qu'un aléa ?", o: ["Conséquence d'une catastrophe", "Phénomène dangereux potentiel", "Mesure de prévention", "Résultat économique"], a: "b" },
            { q: "Qu'est-ce qu'un enjeu ?", o: ["Cause d'un risque", "Élément menacé", "Solution technique", "Analyse scientifique"], a: "b" },
            { q: "Comment se définit un risque ?", o: ["Aléa + Enjeux", "Aléa - Vulnérabilité", "Enjeux × Coûts", "Aléa ÷ Prévention"], a: "a" },
            { q: "Qu'est-ce que la vulnérabilité ?", o: ["Résistance aux catastrophes", "Fragilité d'un territoire", "Capacité d'adaptation", "Ressources disponibles"], a: "b" },
            { q: "Exemple de risque naturel ?", o: ["Explosion d'usine", "Séisme", "Marée noire", "Cyberattaque"], a: "b" },
            { q: "Exemple de risque technologique ?", o: ["Ouragan", "Glissement de terrain", "Explosion Lubrizol", "Épidémie"], a: "c" },
            { q: "Qu'est-ce qu'un risque systémique ?", o: ["Risque localisé", "Risque en chaîne", "Risque calculé", "Risque théorique"], a: "b" },
            { q: "Exemple de risque systémique ?", o: ["Inondation", "Séisme → Tsunami → Nucléaire", "Sécheresse", "Feu de forêt"], a: "b" },
            { q: "Pourquoi les pays pauvres sont plus vulnérables ?", o: ["Climat plus rude", "Moins de moyens de prévention", "Plus d'aléas", "Surpopulation"], a: "b" },
            { q: "Quel plan organise les secours en France ?", o: ["Plan Vigipirate", "Plan ORSEC", "Plan Neptune", "Plan Éclipse"], a: "b" },
            { q: "Que signifie PPMS ?", o: ["Plan Prévisionnel de Management des Stocks", "Plan Particulier de Mise en Sûreté", "Programme de Prévention des Maladies Saisonnières", "Protocole de Protection des Milieux Sensibles"], a: "b" },
            { q: "Moyen d'alerte en cas de danger ?", o: ["Radioactivité", "Sirènes", "Bulletins météo", "Sondages"], a: "b" },
            { q: "Aménagement contre les inondations ?", o: ["Éoliennes", "Diguettes", "Panneaux solaires", "Tunnels"], a: "b" },
            { q: "Acteurs de la gestion des risques ?", o: ["États uniquement", "Citoyens uniquement", "ONG uniquement", "Tous ces acteurs"], a: "d" },
            { q: "3 axes de gestion des risques ?", o: ["Prévention, Répression, Reconstruction", "Prévision, Adaptation, Répression", "Prévention, Adaptation, Gestion de crise", "Analyse, Intervention, Communication"], a: "c" }
        ]
    },

    'emc-theme1': {
        title: "EMC - Thème: Défis de Société et Bioéthique",
        questions: [
            { q: "Année des Accords de Paris ?", o: ["2012", "2015", "2018", "2020"], a: "b" },
            { q: "Objectif principal des Accords ?", o: ["Lutter contre le terrorisme", "Réduire les GES", "Promouvoir le nucléaire", "Développer les OGM"], a: "b" },
            { q: "Conférence des Accords de Paris ?", o: ["COP21", "G7", "ONU Environnement", "Sommet de Davos"], a: "a" },
            { q: "Que signifie PMA ?", o: ["Protection Médicale Animale", "Procréation Médicalement Assistée", "Programme Mondial d'Alimentation", "Politique de Maintien de l'Ordre"], a: "b" },
            { q: "PMA légale en France pour toutes ?", o: ["Depuis 2010", "Depuis 2015", "Depuis 2020", "Jamais"], a: "c" },
            { q: "Que signifie GPA ?", o: ["Gestion Publique Agricole", "Gestation Pour Autrui", "Groupe de Protection Animale", "Garantie de Prix Annuel"], a: "b" },
            { q: "GPA autorisée en France ?", o: ["Oui sous conditions", "Non strictement interdite", "Seulement pour les couples hétéros", "Uniquement à l'étranger"], a: "b" },
            { q: "Conséquences de Batsirai à Mayotte ?", o: ["Aucun dégât", "Dégâts matériels seulement", "Dégâts humains et matériels", "Amélioration économique"], a: "c" },
            { q: "Pourquoi les territoires précaires sont plus vulnérables ?", o: ["Meilleure préparation", "Moins d'aléas", "Manque de moyens", "Climat plus stable"], a: "c" },
            { q: "Risques liés au changement climatique ?", o: ["Cyclones et sécheresses", "Tremblements de terre", "Eruptions volcaniques", "Marées noires"], a: "a" },
            { q: "Définition de bioéthique ?", o: ["Étude des écosystèmes", "Règles sur les modifications du vivant", "Droit des animaux", "Politiques agricoles"], a: "b" },
            { q: "Rôle des COP ?", o: ["Gérer les pandémies", "Réguler le commerce", "Lutter contre le changement climatique", "Promouvoir le tourisme"], a: "c" },
            { q: "Exemple de coopération climatique ?", o: ["OTAN", "Accords de Paris", "G20", "UNESCO"], a: "b" },
            { q: "Mouvement contre la dépendance numérique ?", o: ["#MeToo", "Gilets jaunes", "Détox numérique", "Extinction Rebellion"], a: "c" },
            { q: "Enjeu de la bioéthique ?", o: ["Questions scientifiques uniquement", "Équilibre droits individuels/société", "Développement économique", "Protection des animaux"], a: "b" }
        ]
    },

    'francais-oeuvres': {
        title: "Français - Œuvres Étudiées",
        questions: [
            { q: "Qui incarne l'ouvrier aliéné dans Les Temps modernes ?", o: ["Buster Keaton", "Charlie Chaplin", "Jacques Tati", "Louis de Funès"], a: "b" },
            { q: "Critique sociale dans Les Hommes lents ?", o: ["Lenteur administrative", "Rythme effréné de la modernité", "Pollution industrielle", "Inégalités sociales"], a: "b" },
            { q: "Héros de Courir ?", o: ["Usain Bolt", "Émile Zatopek", "Alain Mimoun", "Mo Farah"], a: "b" },
            { q: "Genre de Courir ?", o: ["Roman historique", "Biographie romancée", "Science-fiction", "Théâtre"], a: "b" },
            { q: "Thème central de La Vraie vie ?", o: ["Amour impossible", "Violence familiale", "Aventure spatiale", "Enquête policière"], a: "b" },
            { q: "Narration de La Vraie vie ?", o: ["Troisième personne", "Journal intime", "Première personne", "Témoignage"], a: "c" },
            { q: "Pourquoi la détox numérique ?", o: ["Économiser de l'argent", "Retrouver une vie simple", "Éviter les virus", "Améliorer les performances"], a: "b" },
            { q: "Type de récit du Parfum des fleurs... ?", o: ["Autobiographie", "Roman fantasy", "Polar", "Essai philosophique"], a: "a" },
            { q: "Lieu principal du Parfum des fleurs... ?", o: ["Musée à Venise", "Gare de Lyon", "Bibliothèque nationale", "Stade de France"], a: "a" },
            { q: "Départ de Tout le bleu du ciel ?", o: ["Mariage raté", "Diagnostic médical", "Road trip terminal", "Perte d'emploi"], a: "c" },
            { q: "Ton de Tout le bleu du ciel ?", o: ["Comique", "Mélancolique et poétique", "Horreur", "Suspense"], a: "b" },
            { q: "Œuvre contre l'aliénation numérique ?", o: ["Les Temps modernes", "Good Morning", "La Vraie vie", "Courir"], a: "b" },
            { q: "Lien entre Good Morning et Détox ?", o: ["Critique sociale", "Dépendance numérique", "Écologie", "Sport extrême"], a: "b" },
            { q: "Émotion dans Les Temps modernes ?", o: ["Peur", "Colère", "Honte", "Humour"], a: "d" },
            { q: "Problématique commune aux œuvres ?", o: ["Déshumanisation moderne", "Amour courtois", "Guerre mondiale", "Renaissance artistique"], a: "a" }
        ]
    },

    'francais-figures': {
        title: "Français - Figures de Style",
        questions: [
            { q: "\"Joie violente\" est un...", o: ["Oxymore", "Métaphore", "Hyperbole", "Comparaison"], a: "a" },
            { q: "Donner des traits humains à une machine ?", o: ["Allégorie", "Personnification", "Métonymie", "Litote"], a: "b" },
            { q: "Répétitions sensorielles =", o: ["Accumulation", "Anaphore", "Gradation", "Parallélisme"], a: "a" },
            { q: "Image symbole d'une idée =", o: ["Allégorie", "Euphémisme", "Antithèse", "Synecdoque"], a: "a" },
            { q: "Répétition de gestes mécaniques =", o: ["Anaphore", "Climax", "Énumération", "Hyperbole"], a: "a" },
            { q: "\"Il courait comme s'il volait\" =", o: ["Métaphore", "Comparaison", "Allitération", "Antiphrase"], a: "b" },
            { q: "Dire l'inverse avec ironie =", o: ["Litote", "Antiphrase", "Oxymore", "Chiasme"], a: "b" },
            { q: "\"Pas très tendre\" pour violence =", o: ["Hyperbole", "Litote", "Métaphore", "Comparaison"], a: "b" },
            { q: "Nature qui écoute =", o: ["Allégorie", "Personnification", "Métonymie", "Synecdoque"], a: "b" },
            { q: "Série de mots courts =", o: ["Gradation", "Énumération", "Anaphore", "Parataxe"], a: "b" },
            { q: "Associer plusieurs sens =", o: ["Synesthésie", "Métaphore", "Allitération", "Hyperbole"], a: "a" },
            { q: "\"Le silence hurlait\" =", o: ["Oxymore + Personnification", "Comparaison + Gradation", "Litote + Euphémisme", "Métaphore + Allitération"], a: "a" },
            { q: "\"Ce n'était pas rien\" =", o: ["Hyperbole", "Litote", "Antiphrase", "Euphémisme"], a: "b" },
            { q: "Phrases débutant pareil =", o: ["Gradation", "Anaphore", "Parallélisme", "Chiasme"], a: "b" },
            { q: "Transformation poétique d'objet =", o: ["Métaphore", "Comparaison", "Synecdoque", "Allégorie"], a: "a" }
        ]
    }
};

        // Dynamically build quizzes from quizData
        function buildQuizzes() {
            const quizContentArea = document.getElementById('quiz-content-area');
            for (const quizId in quizData) {
                const themeData = quizData[quizId];
                const quizContainer = document.getElementById(quizId + '-quiz'); // Use existing containers
                if (!quizContainer) {
                    console.warn("Container not found for quizId:", quizId + '-quiz');
                    continue;
                }

                let quizHtml = `<h2 class="quiz-title">${themeData.title}</h2>`;
                quizHtml += `<form id="${quizId}-form">`;

                themeData.questions.forEach((item, index) => {
                    const questionName = `${quizId}-q${index + 1}`;
                    quizHtml += `
                        <div class="question-block">
                            <p class="question-text">${index + 1}. ${item.q}</p>
                            <div class="options">
                                <input type="radio" id="${questionName}-a" name="${questionName}" value="a"><label for="${questionName}-a">a) ${item.o[0]}</label>
                                <input type="radio" id="${questionName}-b" name="${questionName}" value="b"><label for="${questionName}-b">b) ${item.o[1]}</label>
                                <input type="radio" id="${questionName}-c" name="${questionName}" value="c"><label for="${questionName}-c">c) ${item.o[2]}</label>
                                ${item.o.length > 3 ? `<input type="radio" id="${questionName}-d" name="${questionName}" value="d"><label for="${questionName}-d">d) ${item.o[3]}</label>` : ''}
                            </div>
                        </div>
                    `;
                });

                quizHtml += `<button type="button" class="submit-quiz-button" onclick="submitQuiz('${quizId}')">Valider le Quiz</button>`;
                quizHtml += `<div id="${quizId}-results" class="results-display" style="display:none;"></div>`;
                quizHtml += `</form>`;
                quizContainer.innerHTML = quizHtml;
            }
        }
        
        // Call this function when the page loads
        document.addEventListener('DOMContentLoaded', buildQuizzes);


        let currentQuizId = null; // Holds the ID like 'histoire-theme1'
        let currentSubNavbarId = null; // Holds the ID like 'histoire-subnav'

        function showSubNavbar(subNavbarId) {
            document.querySelectorAll('.sub-navbar').forEach(nav => nav.style.display = 'none');
            document.querySelectorAll('.quiz-container').forEach(qc => qc.classList.remove('active'));
            document.getElementById('welcome-message').style.display = 'none';
            document.querySelectorAll('.nav-button').forEach(btn => btn.classList.remove('active'));
            
            const mainButton = document.querySelector(`.nav-button[onclick="showSubNavbar('${subNavbarId}')"]`);
            if (mainButton) mainButton.classList.add('active');

            const subNav = document.getElementById(subNavbarId);
            if (subNav) {
                subNav.style.display = 'flex';
                currentSubNavbarId = subNavbarId;
            }
        }

        function showQuiz(quizId) { // quizId is like 'histoire-theme1'
            document.getElementById('welcome-message').style.display = 'none';
            document.querySelectorAll('.quiz-container').forEach(qc => qc.classList.remove('active'));
            
            if (currentSubNavbarId) {
                document.querySelectorAll(`#${currentSubNavbarId} .sub-nav-button`).forEach(btn => btn.classList.remove('active'));
            }
            
            const subButton = document.querySelector(`.sub-nav-button[onclick="showQuiz('${quizId}')"]`);
            if (subButton) subButton.classList.add('active');

            const quizContainer = document.getElementById(quizId + '-quiz'); // e.g., 'histoire-theme1-quiz'
            if (quizContainer) {
                quizContainer.classList.add('active');
                currentQuizId = quizId; // Store the base quizId
                const form = document.getElementById(quizId + '-form');
                if (form) form.reset();
                // Clear previous feedback specifically within this quiz container
                quizContainer.querySelectorAll('.feedback').forEach(el => el.remove());
                const resultsDisplay = document.getElementById(quizId + '-results');
                if (resultsDisplay) resultsDisplay.style.display = 'none';
                quizContainer.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }
        }

        function submitQuiz(quizId) { // quizId is like 'histoire-theme1'
            const form = document.getElementById(quizId + '-form');
            const resultsDisplay = document.getElementById(quizId + '-results');

            if (!form || !resultsDisplay || !quizData[quizId]) return;

            let score = 0;
            const themeQuestions = quizData[quizId].questions;
            const totalQuestions = themeQuestions.length;
            
            // Clear previous feedback specifically within this quiz's form
            form.querySelectorAll('.feedback').forEach(el => el.remove());

            themeQuestions.forEach((item, index) => {
                const questionName = `${quizId}-q${index + 1}`;
                const radioGroup = form.elements[questionName];
                if (!radioGroup) return;

                const selectedOptionNode = form.querySelector(`input[name="${questionName}"]:checked`);
                const selectedOptionValue = selectedOptionNode ? selectedOptionNode.value : null;
                const correctAnswerLetter = item.a; // Correct answer letter (a, b, c, d)
                
                const questionBlock = radioGroup.length ? radioGroup[0].closest('.question-block') : radioGroup.closest('.question-block');
                if (!questionBlock) return;

                const feedbackElement = document.createElement('p');
                feedbackElement.classList.add('feedback');
                
                let correctAnswerText = "Non définie";
                const correctOptionIndex = correctAnswerLetter.charCodeAt(0) - 'a'.charCodeAt(0);
                if (item.o[correctOptionIndex] !== undefined) {
                    correctAnswerText = item.o[correctOptionIndex];
                }

                if (selectedOptionValue) {
                    if (selectedOptionValue === correctAnswerLetter) {
                        score++;
                        feedbackElement.innerHTML = '<strong class="correct">Correct !</strong>';
                        feedbackElement.classList.add('correct-answer-feedback');
                    } else {
                        feedbackElement.innerHTML = `<strong class="incorrect">Incorrect.</strong> La bonne réponse était : <strong>${correctAnswerLetter.toUpperCase()}) ${correctAnswerText}</strong>`;
                        feedbackElement.classList.add('incorrect-answer-feedback');
                    }
                } else {
                    feedbackElement.innerHTML = `<strong class="incorrect">Pas de réponse.</strong> La bonne réponse était : <strong>${correctAnswerLetter.toUpperCase()}) ${correctAnswerText}</strong>`;
                    feedbackElement.classList.add('incorrect-answer-feedback');
                }
                questionBlock.appendChild(feedbackElement);
            });

            let scoreMessage = `Votre score : ${score} / ${totalQuestions}.<br>`;
            if (score === totalQuestions) scoreMessage += "Excellent travail, c'est un sans-faute ! 🎉";
            else if (score >= totalQuestions * 0.7) scoreMessage += "Très bon score, continuez comme ça ! 👍";
            else if (score >= totalQuestions * 0.5) scoreMessage += "Pas mal, mais vous pouvez vous améliorer. 😊";
            else scoreMessage += "Il y a encore du travail. Revoyez vos fiches. 💪";
            
            resultsDisplay.innerHTML = scoreMessage;
            resultsDisplay.style.display = 'block';
            resultsDisplay.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }

    </script>
</body>
</html>
